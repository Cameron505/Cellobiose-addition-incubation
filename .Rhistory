)
}
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_point(size=3,stroke=1, alpha = 0.5,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "all samples",
subtitle = "separation by Temp")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_point(size=3,stroke=1, alpha = 0.5,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_point(size=20,stroke=1, alpha = 0.5,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_point(size=10,stroke=1, alpha = 0.5,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_point(size=5,stroke=1, alpha = 0.5,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_point(size=5,stroke=1, alpha = 0,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_point(size=5,stroke=1, alpha = 0.9,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0, lwd=5) +
geom_point(size=5,stroke=1, alpha = 0.9,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0, lwd=20) +
geom_point(size=5,stroke=1, alpha = 0.9,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, lwd=5, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_point(size=5,stroke=1, alpha = 0.9,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, lwd=25, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_point(size=5,stroke=1, alpha = 0.9,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, size=5, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_point(size=5,stroke=1, alpha = 0.9,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),lwd=5,
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0)
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0, size =5)
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0, lwd =5)
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0, lwd =5) +
stat_ellipse(lwd=5)
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0, lwd =5) +
stat_ellipse(groups = as.character(pca_1$grp$Temp),lwd=5)
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0, lwd =5) +
stat_ellipse(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0, lwd =5)
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0, lwd =5)
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
stat_ellipse()+
geom_point(size=5,stroke=1, alpha = 0.9,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
pca_1$grp$Temp
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
stat_ellipse(color=as.character(pca_1$grp$Temp))
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
stat_ellipse(color=pca_1$grp$Temp)
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE)
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE) +
geom_point(size=5,stroke=1, alpha = 0.9,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, lwd=5) +
geom_point(size=5,stroke=1, alpha = 0.9,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
geom_point(size=5,stroke=1, alpha = 0.9,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_line(size=5)
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_point(size=5,stroke=1, alpha = 0.9,
aes(#shape = groups,
color = groups))
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_point(size=3,stroke=1, alpha = 0.9,
aes(#shape = groups,
color = groups))
ggbiplot(pca_1$pca_int, obs.scale = 1, var.scale = 1,
groups = as.character(pca_1$grp$Temp),
ellipse = TRUE, circle = FALSE, var.axes = TRUE, alpha = 0) +
geom_point(size=3,stroke=1, alpha = 0.9,
aes(#shape = groups,
color = groups))+
#scale_shape_manual(values = c(21, 22, 19), name = "", guide = "none")+
xlim(-4,4)+
ylim(-3.5,3.5)+
labs(shape="",
title = "",
subtitle = "")+
ggtitle("")+
theme_CKM()
A = read.csv("Data/RES2.csv")
A = read.csv("Data/CB_RES.csv")
A$Date<- as.Date(A$Date, format="%m/%d/%Y")
cbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
A<-A[A$ID!='C10-2',]
View(A)
A = read.csv("Data/CB_RES.csv")
View(A)
A$csum <- ave(A$Res.2, A$ID, FUN=cumsum)
A<-read.csv("CB_RES.csv")
A<-read.csv("Data/CB_RES.csv")
A$Date<-as.Date(A$Date,"%m/%d/%Y")
cbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2", "#D55E00", "#CC79A7")
A$JD <- strftime(A$Date, format = "%j")
A$JD<-as.numeric(A$JD)
A$Res.22<-A$Average*24     #change from per hour to per day
A$JD2<-A$JD-178
CUM<-A %>%
group_by(Cadd,Temperature,Sample) %>%
summarize(val=cumtrapz(JD2,Res.22),D=JD2)
library(tidyverse)
CUM<-A %>%
group_by(Cadd,Temperature,Sample) %>%
summarize(val=cumtrapz(JD2,Res.22),D=JD2)
library(pracma)
CUM<-A %>%
group_by(Cadd,Temperature,Sample) %>%
summarize(val=cumtrapz(JD2,Res.22),D=JD2)
CUM2<-A %>%
group_by(Cadd,Temperature,Sample) %>%
summarize(val=trapz(JD2,Res.22))
CUM2$TCR<-CUM2$val*12.005 #Multiply by average dry mass
CUM$TCR<-CUM$val*12.005
OQN<-CUM[CUM$Temperature<=0,]
OQP<-CUM[CUM$Temperature>=0,]
OQN$Cadd<-as.factor(OQN$Cadd)
OQP$Cadd<-as.factor(OQP$Cadd)
ggplot(OQN, aes(x=D, y=TCR, color= OQN$Cadd))+
stat_summary(fun = mean,geom = "point",lwd=4) +
stat_summary(fun.data = mean_se, geom = "errorbar", lwd=1, width = 0.5)+
facet_wrap(~Temperature)+
theme_light()+
scale_colour_manual(values=cbPalette)+
scale_fill_manual(values=cbPalette)+
ylab(expression(paste( " ",mu,"g-C")))+
xlab("incubation day")+
labs(color="C-addition")+
theme(legend.direction = 'vertical',
legend.key = element_rect(size=2),
legend.key.size = unit(3, 'lines'),
panel.grid.major = element_blank(),
legend.title=element_text(size=40,colour='black'),
panel.grid.minor = element_blank(),
legend.text=element_text(size=35),
axis.title.y= element_text(size=40, colour='black'),
axis.text.y = element_text(size=40, colour='black'),
axis.ticks = element_line(colour = "black", size=2),
axis.ticks.length = unit(0.3, "cm"),
axis.title.x=element_text(size=40, colour='black', vjust=-0.1),
axis.text.x = element_text(size=40, colour='black', angle=45, vjust= 0.5),
panel.border = element_rect(colour = "black", fill=NA, size=2),
plot.title = element_text( size=40, face="bold.italic"),
plot.margin=unit(c(1,1,1,1), "cm"))+
ggtitle("Soil Respiration (below freezing)")
CUM$Cadd<-as.factor(CUM$Cadd)
ggplot(CUM, aes(x=D, y=TCR, color=Add))+
stat_summary(fun.y = mean,geom = "point",lwd=4) +
stat_summary(fun.data = mean_se, geom = "errorbar", lwd=1, width = 0.5)+
facet_wrap(~Temp)+
theme_light()+
scale_colour_manual(values=cbPalette)+
scale_fill_manual(values=cbPalette)+
ylab(expression(paste( " ",mu,"g-C")))+
xlab("Date")+
theme(legend.direction = 'vertical',
legend.key = element_rect(size=2),
legend.key.size = unit(3, 'lines'),
panel.grid.major = element_blank(),
legend.title=element_text(size=40,colour='black'),
panel.grid.minor = element_blank(),
legend.text=element_text(size=35),
axis.title.y= element_text(size=40, colour='black'),
axis.text.y = element_text(size=40, colour='black'),
axis.ticks = element_line(colour = "black", size=2),
axis.ticks.length = unit(0.3, "cm"),
axis.title.x=element_text(size=40, colour='black'),
axis.text.x = element_text(size=40, colour='black'),
panel.border = element_rect(colour = "black", fill=NA, size=2),
plot.title = element_text( size=40, face="bold.italic"),
plot.margin=unit(c(1,1,1,1), "cm"))+
ggtitle("Soil Respiration (above freezing)")
View(CUM)
View(CUM2)
CUM<-A %>%
group_by(Cadd,Temperature,Sample) %>%
summarize(val=cumtrapz(JD2,Res.22),D=JD2)
View(CUM)
CUM$TCR<-CUM$val*12.005
View(CUM)
ggplot(CUM, aes(x=D, y=TCR, color=Add))+
stat_summary(fun.y = mean,geom = "point",lwd=4)
ggplot(CUM, aes(x=D, y=TCR, color=Cadd))+
stat_summary(fun.y = mean,geom = "point",lwd=4)
ggplot(CUM, aes(x=D, y=TCR, color=Cadd))+
stat_summary(fun.y = mean,geom = "point",lwd=4) +
stat_summary(fun.data = mean_se, geom = "errorbar", lwd=1, width = 0.5)+
facet_wrap(~Temp)
View(CUM)
View(CUM)
ggplot(CUM, aes(x=D, y=TCR, color=Cadd))+
stat_summary(fun.y = mean,geom = "point",lwd=4) +
stat_summary(fun.data = mean_se, geom = "errorbar", lwd=1, width = 0.5)+
facet_wrap(~Temperature)+
theme_light()
View(CUM)
CUM$Cadd<-as.factor(CUM$Cadd)
ggplot(CUM, aes(x=D, y=TCR, color=Cadd))+
stat_summary(fun.y = mean,geom = "point",lwd=4) +
stat_summary(fun.data = mean_se, geom = "errorbar", lwd=1, width = 0.5)+
facet_wrap(~Temperature)+
theme_light()+
scale_colour_manual(values=cbPalette)+
scale_fill_manual(values=cbPalette)+
ylab(expression(paste( " ",mu,"g-C")))+
xlab("Date")+
theme(legend.direction = 'vertical',
legend.key = element_rect(size=2),
legend.key.size = unit(3, 'lines'),
panel.grid.major = element_blank(),
legend.title=element_text(size=40,colour='black'),
panel.grid.minor = element_blank(),
legend.text=element_text(size=35),
axis.title.y= element_text(size=40, colour='black'),
axis.text.y = element_text(size=40, colour='black'),
axis.ticks = element_line(colour = "black", size=2),
axis.ticks.length = unit(0.3, "cm"),
axis.title.x=element_text(size=40, colour='black'),
axis.text.x = element_text(size=40, colour='black'),
panel.border = element_rect(colour = "black", fill=NA, size=2),
plot.title = element_text( size=40, face="bold.italic"),
plot.margin=unit(c(1,1,1,1), "cm"))+
ggtitle("Soil Respiration (above freezing)")
ggplot(CUM, aes(x=D, y=TCR, color=Cadd))+
stat_summary(fun.y = mean,geom = "point",lwd=3) +
stat_summary(fun.data = mean_se, geom = "errorbar", lwd=1, width = 0.5)+
facet_wrap(~Temperature)+
theme_light()+
scale_colour_manual(values=cbPalette)+
scale_fill_manual(values=cbPalette)+
ylab(expression(paste( " ",mu,"g-C")))+
xlab("Date")+
theme(legend.direction = 'vertical',
legend.key = element_rect(size=2),
legend.key.size = unit(3, 'lines'),
panel.grid.major = element_blank(),
legend.title=element_text(size=30,colour='black'),
panel.grid.minor = element_blank(),
legend.text=element_text(size=25),
axis.title.y= element_text(size=30, colour='black'),
axis.text.y = element_text(size=30, colour='black'),
axis.ticks = element_line(colour = "black", size=2),
axis.ticks.length = unit(0.3, "cm"),
axis.title.x=element_text(size=30, colour='black'),
axis.text.x = element_text(size=30, colour='black'),
panel.border = element_rect(colour = "black", fill=NA, size=2),
plot.title = element_text( size=30, face="bold.italic"),
plot.margin=unit(c(1,1,1,1), "cm"))+
ggtitle("Soil Respiration (above freezing)")
ggplot(CUM, aes(x=D, y=TCR, color=Cadd))+
stat_summary(fun.y = mean,geom = "point",lwd=3) +
stat_summary(fun.data = mean_se, geom = "errorbar", lwd=1, width = 0.5)+
facet_wrap(~Temperature)+
theme_light()+
scale_colour_manual(values=cbPalette)+
scale_fill_manual(values=cbPalette)+
ylab(expression(paste( " ",mu,"g-C")))+
xlab("Date")+
theme(legend.direction = 'vertical',
legend.key = element_rect(size=2),
legend.key.size = unit(3, 'lines'),
panel.grid.major = element_blank(),
legend.title=element_text(size=30,colour='black'),
panel.grid.minor = element_blank(),
legend.text=element_text(size=25),
axis.title.y= element_text(size=30, colour='black'),
axis.text.y = element_text(size=30, colour='black'),
axis.ticks = element_line(colour = "black", size=2),
axis.ticks.length = unit(0.3, "cm"),
axis.title.x=element_text(size=30, colour='black'),
axis.text.x = element_text(size=30, colour='black'),
panel.border = element_rect(colour = "black", fill=NA, size=2),
plot.title = element_text( size=30, face="bold.italic"),
plot.margin=unit(c(1,1,1,1), "cm"))+
ggtitle("Soil Respiration")
ggplot(CUM, aes(x=D, y=TCR, color=Cadd))+
stat_summary(fun.y = mean,geom = "point",lwd=3) +
stat_summary(fun.data = mean_se, geom = "errorbar", lwd=1, width = 0.5)+
facet_wrap(~Temperature)+
theme_light()+
scale_colour_manual(values=cbPalette)+
scale_fill_manual(values=cbPalette)+
ylab(expression(paste( " ",mu,"g-C")))+
xlab("Date")+
theme(legend.direction = 'vertical',
legend.key = element_rect(size=2),
legend.key.size = unit(3, 'lines'),
panel.grid.major = element_blank(),
legend.title=element_text(size=30,colour='black'),
panel.grid.minor = element_blank(),
legend.text=element_text(size=25),
axis.title.y= element_text(size=30, colour='black'),
axis.text.y = element_text(size=20, colour='black'),
axis.ticks = element_line(colour = "black", size=2),
axis.ticks.length = unit(0.3, "cm"),
axis.title.x=element_text(size=30, colour='black'),
axis.text.x = element_text(size=20, colour='black'),
panel.border = element_rect(colour = "black", fill=NA, size=2),
plot.title = element_text( size=30, face="bold.italic"),
plot.margin=unit(c(1,1,1,1), "cm"))+
ggtitle("Soil Respiration")
